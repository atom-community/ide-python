/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
}); // tslint:disable:all

var vscMockArrays;

(function (vscMockArrays) {
  /**
   * Returns the last element of an array.
   * @param array The array.
   * @param n Which element from the end (default is zero).
   */
  function tail(array, n = 0) {
    return array[array.length - (1 + n)];
  }

  vscMockArrays.tail = tail;

  function equals(one, other, itemEquals = (a, b) => a === b) {
    if (one.length !== other.length) {
      return false;
    }

    for (let i = 0, len = one.length; i < len; i++) {
      if (!itemEquals(one[i], other[i])) {
        return false;
      }
    }

    return true;
  }

  vscMockArrays.equals = equals;

  function binarySearch(array, key, comparator) {
    let low = 0,
        high = array.length - 1;

    while (low <= high) {
      let mid = (low + high) / 2 | 0;
      let comp = comparator(array[mid], key);

      if (comp < 0) {
        low = mid + 1;
      } else if (comp > 0) {
        high = mid - 1;
      } else {
        return mid;
      }
    }

    return -(low + 1);
  }

  vscMockArrays.binarySearch = binarySearch;
  /**
   * Takes a sorted array and a function p. The array is sorted in such a way that all elements where p(x) is false
   * are located before all elements where p(x) is true.
   * @returns the least x for which p(x) is true or array.length if no element fullfills the given function.
   */

  function findFirst(array, p) {
    let low = 0,
        high = array.length;

    if (high === 0) {
      return 0; // no children
    }

    while (low < high) {
      let mid = Math.floor((low + high) / 2);

      if (p(array[mid])) {
        high = mid;
      } else {
        low = mid + 1;
      }
    }

    return low;
  }

  vscMockArrays.findFirst = findFirst;
  /**
   * Like `Array#sort` but always stable. Usually runs a little slower `than Array#sort`
   * so only use this when actually needing stable sort.
   */

  function mergeSort(data, compare) {
    _divideAndMerge(data, compare);

    return data;
  }

  vscMockArrays.mergeSort = mergeSort;

  function _divideAndMerge(data, compare) {
    if (data.length <= 1) {
      // sorted
      return;
    }

    const p = data.length / 2 | 0;
    const left = data.slice(0, p);
    const right = data.slice(p);

    _divideAndMerge(left, compare);

    _divideAndMerge(right, compare);

    let leftIdx = 0;
    let rightIdx = 0;
    let i = 0;

    while (leftIdx < left.length && rightIdx < right.length) {
      let ret = compare(left[leftIdx], right[rightIdx]);

      if (ret <= 0) {
        // smaller_equal -> take left to preserve order
        data[i++] = left[leftIdx++];
      } else {
        // greater -> take right
        data[i++] = right[rightIdx++];
      }
    }

    while (leftIdx < left.length) {
      data[i++] = left[leftIdx++];
    }

    while (rightIdx < right.length) {
      data[i++] = right[rightIdx++];
    }
  }

  function groupBy(data, compare) {
    const result = [];
    let currentGroup;

    for (const element of mergeSort(data.slice(0), compare)) {
      if (!currentGroup || compare(currentGroup[0], element) !== 0) {
        currentGroup = [element];
        result.push(currentGroup);
      } else {
        currentGroup.push(element);
      }
    }

    return result;
  }

  vscMockArrays.groupBy = groupBy;
  /**
   * Diffs two *sorted* arrays and computes the splices which apply the diff.
   */

  function sortedDiff(before, after, compare) {
    const result = [];

    function pushSplice(start, deleteCount, toInsert) {
      if (deleteCount === 0 && toInsert.length === 0) {
        return;
      }

      const latest = result[result.length - 1];

      if (latest && latest.start + latest.deleteCount === start) {
        latest.deleteCount += deleteCount;
        latest.toInsert.push(...toInsert);
      } else {
        result.push({
          start,
          deleteCount,
          toInsert
        });
      }
    }

    let beforeIdx = 0;
    let afterIdx = 0;

    while (true) {
      if (beforeIdx === before.length) {
        pushSplice(beforeIdx, 0, after.slice(afterIdx));
        break;
      }

      if (afterIdx === after.length) {
        pushSplice(beforeIdx, before.length - beforeIdx, []);
        break;
      }

      const beforeElement = before[beforeIdx];
      const afterElement = after[afterIdx];
      const n = compare(beforeElement, afterElement);

      if (n === 0) {
        // equal
        beforeIdx += 1;
        afterIdx += 1;
      } else if (n < 0) {
        // beforeElement is smaller -> before element removed
        pushSplice(beforeIdx, 1, []);
        beforeIdx += 1;
      } else if (n > 0) {
        // beforeElement is greater -> after element added
        pushSplice(beforeIdx, 0, [afterElement]);
        afterIdx += 1;
      }
    }

    return result;
  }

  vscMockArrays.sortedDiff = sortedDiff;
  /**
   * Takes two *sorted* arrays and computes their delta (removed, added elements).
   * Finishes in `Math.min(before.length, after.length)` steps.
   * @param before
   * @param after
   * @param compare
   */

  function delta(before, after, compare) {
    const splices = sortedDiff(before, after, compare);
    const removed = [];
    const added = [];

    for (const splice of splices) {
      removed.push(...before.slice(splice.start, splice.start + splice.deleteCount));
      added.push(...splice.toInsert);
    }

    return {
      removed,
      added
    };
  }

  vscMockArrays.delta = delta;
  /**
   * Returns the top N elements from the array.
   *
   * Faster than sorting the entire array when the array is a lot larger than N.
   *
   * @param array The unsorted array.
   * @param compare A sort function for the elements.
   * @param n The number of elements to return.
   * @return The first n elemnts from array when sorted with compare.
   */

  function top(array, compare, n) {
    if (n === 0) {
      return [];
    }

    const result = array.slice(0, n).sort(compare);
    topStep(array, compare, result, n, array.length);
    return result;
  }

  vscMockArrays.top = top;

  function topStep(array, compare, result, i, m) {
    for (const n = result.length; i < m; i++) {
      const element = array[i];

      if (compare(element, result[n - 1]) < 0) {
        result.pop();
        const j = findFirst(result, e => compare(element, e) < 0);
        result.splice(j, 0, element);
      }
    }
  }
  /**
   * @returns a new array with all undefined or null values removed. The original array is not modified at all.
   */


  function coalesce(array) {
    if (!array) {
      return array;
    }

    return array.filter(e => !!e);
  }

  vscMockArrays.coalesce = coalesce;
  /**
   * Moves the element in the array for the provided positions.
   */

  function move(array, from, to) {
    array.splice(to, 0, array.splice(from, 1)[0]);
  }

  vscMockArrays.move = move;
  /**
   * @returns {{false}} if the provided object is an array
   * 	and not empty.
   */

  function isFalsyOrEmpty(obj) {
    return !Array.isArray(obj) || obj.length === 0;
  }

  vscMockArrays.isFalsyOrEmpty = isFalsyOrEmpty;
  /**
   * Removes duplicates from the given array. The optional keyFn allows to specify
   * how elements are checked for equalness by returning a unique string for each.
   */

  function distinct(array, keyFn) {
    if (!keyFn) {
      return array.filter((element, position) => {
        return array.indexOf(element) === position;
      });
    }

    const seen = Object.create(null);
    return array.filter(elem => {
      const key = keyFn(elem);

      if (seen[key]) {
        return false;
      }

      seen[key] = true;
      return true;
    });
  }

  vscMockArrays.distinct = distinct;

  function uniqueFilter(keyFn) {
    const seen = Object.create(null);
    return element => {
      const key = keyFn(element);

      if (seen[key]) {
        return false;
      }

      seen[key] = true;
      return true;
    };
  }

  vscMockArrays.uniqueFilter = uniqueFilter;

  function firstIndex(array, fn) {
    for (let i = 0; i < array.length; i++) {
      const element = array[i];

      if (fn(element)) {
        return i;
      }
    }

    return -1;
  }

  vscMockArrays.firstIndex = firstIndex;

  function first(array, fn, notFoundValue = null) {
    const index = firstIndex(array, fn);
    return index < 0 ? notFoundValue : array[index];
  }

  vscMockArrays.first = first;

  function commonPrefixLength(one, other, equals = (a, b) => a === b) {
    let result = 0;

    for (let i = 0, len = Math.min(one.length, other.length); i < len && equals(one[i], other[i]); i++) {
      result++;
    }

    return result;
  }

  vscMockArrays.commonPrefixLength = commonPrefixLength;

  function flatten(arr) {
    return [].concat(...arr);
  }

  vscMockArrays.flatten = flatten;

  function range(arg, to) {
    let from = typeof to === 'number' ? arg : 0;

    if (typeof to === 'number') {
      from = arg;
    } else {
      from = 0;
      to = arg;
    }

    const result = [];

    if (from <= to) {
      for (let i = from; i < to; i++) {
        result.push(i);
      }
    } else {
      for (let i = from; i > to; i--) {
        result.push(i);
      }
    }

    return result;
  }

  vscMockArrays.range = range;

  function fill(num, valueFn, arr = []) {
    for (let i = 0; i < num; i++) {
      arr[i] = valueFn();
    }

    return arr;
  }

  vscMockArrays.fill = fill;

  function index(array, indexer, merger = t => t) {
    return array.reduce((r, t) => {
      const key = indexer(t);
      r[key] = merger(t, r[key]);
      return r;
    }, Object.create(null));
  }

  vscMockArrays.index = index;
  /**
   * Inserts an element into an array. Returns a function which, when
   * called, will remove that element from the array.
   */

  function insert(array, element) {
    array.push(element);
    return () => {
      const index = array.indexOf(element);

      if (index > -1) {
        array.splice(index, 1);
      }
    };
  }

  vscMockArrays.insert = insert;
  /**
   * Insert `insertArr` inside `target` at `insertIndex`.
   * Please don't touch unless you understand https://jsperf.com/inserting-an-array-within-an-array
   */

  function arrayInsert(target, insertIndex, insertArr) {
    const before = target.slice(0, insertIndex);
    const after = target.slice(insertIndex);
    return before.concat(insertArr, after);
  }

  vscMockArrays.arrayInsert = arrayInsert;
})(vscMockArrays = exports.vscMockArrays || (exports.vscMockArrays = {}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFycmF5cy5qcyJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsInZzY01vY2tBcnJheXMiLCJ0YWlsIiwiYXJyYXkiLCJuIiwibGVuZ3RoIiwiZXF1YWxzIiwib25lIiwib3RoZXIiLCJpdGVtRXF1YWxzIiwiYSIsImIiLCJpIiwibGVuIiwiYmluYXJ5U2VhcmNoIiwia2V5IiwiY29tcGFyYXRvciIsImxvdyIsImhpZ2giLCJtaWQiLCJjb21wIiwiZmluZEZpcnN0IiwicCIsIk1hdGgiLCJmbG9vciIsIm1lcmdlU29ydCIsImRhdGEiLCJjb21wYXJlIiwiX2RpdmlkZUFuZE1lcmdlIiwibGVmdCIsInNsaWNlIiwicmlnaHQiLCJsZWZ0SWR4IiwicmlnaHRJZHgiLCJyZXQiLCJncm91cEJ5IiwicmVzdWx0IiwiY3VycmVudEdyb3VwIiwiZWxlbWVudCIsInB1c2giLCJzb3J0ZWREaWZmIiwiYmVmb3JlIiwiYWZ0ZXIiLCJwdXNoU3BsaWNlIiwic3RhcnQiLCJkZWxldGVDb3VudCIsInRvSW5zZXJ0IiwibGF0ZXN0IiwiYmVmb3JlSWR4IiwiYWZ0ZXJJZHgiLCJiZWZvcmVFbGVtZW50IiwiYWZ0ZXJFbGVtZW50IiwiZGVsdGEiLCJzcGxpY2VzIiwicmVtb3ZlZCIsImFkZGVkIiwic3BsaWNlIiwidG9wIiwic29ydCIsInRvcFN0ZXAiLCJtIiwicG9wIiwiaiIsImUiLCJjb2FsZXNjZSIsImZpbHRlciIsIm1vdmUiLCJmcm9tIiwidG8iLCJpc0ZhbHN5T3JFbXB0eSIsIm9iaiIsIkFycmF5IiwiaXNBcnJheSIsImRpc3RpbmN0Iiwia2V5Rm4iLCJwb3NpdGlvbiIsImluZGV4T2YiLCJzZWVuIiwiY3JlYXRlIiwiZWxlbSIsInVuaXF1ZUZpbHRlciIsImZpcnN0SW5kZXgiLCJmbiIsImZpcnN0Iiwibm90Rm91bmRWYWx1ZSIsImluZGV4IiwiY29tbW9uUHJlZml4TGVuZ3RoIiwibWluIiwiZmxhdHRlbiIsImFyciIsImNvbmNhdCIsInJhbmdlIiwiYXJnIiwiZmlsbCIsIm51bSIsInZhbHVlRm4iLCJpbmRleGVyIiwibWVyZ2VyIiwidCIsInJlZHVjZSIsInIiLCJpbnNlcnQiLCJhcnJheUluc2VydCIsInRhcmdldCIsImluc2VydEluZGV4IiwiaW5zZXJ0QXJyIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBQSxNQUFNLENBQUNDLGNBQVAsQ0FBc0JDLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDO0FBQUVDLEVBQUFBLEtBQUssRUFBRTtBQUFULENBQTdDLEUsQ0FDQTs7QUFDQSxJQUFJQyxhQUFKOztBQUNBLENBQUMsVUFBVUEsYUFBVixFQUF5QjtBQUN0QjtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0ksV0FBU0MsSUFBVCxDQUFjQyxLQUFkLEVBQXFCQyxDQUFDLEdBQUcsQ0FBekIsRUFBNEI7QUFDeEIsV0FBT0QsS0FBSyxDQUFDQSxLQUFLLENBQUNFLE1BQU4sSUFBZ0IsSUFBSUQsQ0FBcEIsQ0FBRCxDQUFaO0FBQ0g7O0FBQ0RILEVBQUFBLGFBQWEsQ0FBQ0MsSUFBZCxHQUFxQkEsSUFBckI7O0FBQ0EsV0FBU0ksTUFBVCxDQUFnQkMsR0FBaEIsRUFBcUJDLEtBQXJCLEVBQTRCQyxVQUFVLEdBQUcsQ0FBQ0MsQ0FBRCxFQUFJQyxDQUFKLEtBQVVELENBQUMsS0FBS0MsQ0FBekQsRUFBNEQ7QUFDeEQsUUFBSUosR0FBRyxDQUFDRixNQUFKLEtBQWVHLEtBQUssQ0FBQ0gsTUFBekIsRUFBaUM7QUFDN0IsYUFBTyxLQUFQO0FBQ0g7O0FBQ0QsU0FBSyxJQUFJTyxDQUFDLEdBQUcsQ0FBUixFQUFXQyxHQUFHLEdBQUdOLEdBQUcsQ0FBQ0YsTUFBMUIsRUFBa0NPLENBQUMsR0FBR0MsR0FBdEMsRUFBMkNELENBQUMsRUFBNUMsRUFBZ0Q7QUFDNUMsVUFBSSxDQUFDSCxVQUFVLENBQUNGLEdBQUcsQ0FBQ0ssQ0FBRCxDQUFKLEVBQVNKLEtBQUssQ0FBQ0ksQ0FBRCxDQUFkLENBQWYs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RUFBQUEsYUFBYSxDQUFDcUcsV0FBZCxHQUE0QkEsV0FBNUI7QUFDSCxDQTFXRCxFQTBXR3JHLGFBQWEsR0FBR0YsT0FBTyxDQUFDRSxhQUFSLEtBQTBCRixPQUFPLENBQUNFLGFBQVIsR0FBd0IsRUFBbEQsQ0ExV25CIiwic291cmNlc0NvbnRlbnQiOlsiLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4ndXNlIHN0cmljdCc7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vLyB0c2xpbnQ6ZGlzYWJsZTphbGxcbnZhciB2c2NNb2NrQXJyYXlzO1xuKGZ1bmN0aW9uICh2c2NNb2NrQXJyYXlzKSB7XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbGFzdCBlbGVtZW50IG9mIGFuIGFycmF5LlxuICAgICAqIEBwYXJhbSBhcnJheSBUaGUgYXJyYXkuXG4gICAgICogQHBhcmFtIG4gV2hpY2ggZWxlbWVudCBmcm9tIHRoZSBlbmQgKGRlZmF1bHQgaXMgemVybykuXG4gICAgICovXG4gICAgZnVuY3Rpb24gdGFpbChhcnJheSwgbiA9IDApIHtcbiAgICAgICAgcmV0dXJuIGFycmF5W2FycmF5Lmxlbmd0aCAtICgxICsgbildO1xuICAgIH1cbiAgICB2c2NNb2NrQXJyYXlzLnRhaWwgPSB0YWlsO1xuICAgIGZ1bmN0aW9uIGVxdWFscyhvbmUsIG90aGVyLCBpdGVtRXF1YWxzID0gKGEsIGIpID0+IGEgPT09IGIpIHtcbiAgICAgICAgaWYgKG9uZS5sZW5ndGggIT09IG90aGVyLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBvbmUubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGlmICghaXRlbUVxdWFscyhvbmVbaV0sIG90aGVyW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgdnNjTW9ja0FycmF5cy5lcXVhbHMgPSBlcXVhbHM7XG4gICAgZnVuY3Rpb24gYmluYXJ5U2VhcmNoKGFycmF5LCBrZXksIGNvbXBhcmF0b3IpIHtcbiAgICAgICAgbGV0IGxvdyA9IDAsIGhpZ2ggPSBhcnJheS5sZW5ndGggLSAxO1xuICAgICAgICB3aGlsZSAobG93IDw9IGhpZ2gpIHtcbiAgICAgICAgICAgIGxldCBtaWQgPSAoKGxvdyArIGhpZ2gpIC8gMikgfCAwO1xuICAgICAgICAgICAgbGV0IGNvbXAgPSBjb21wYXJhdG9yKGFycmF5W21pZF0sIGtleSk7XG4gICAgICAgICAgICBpZiAoY29tcCA8IDApIHtcbiAgICAgICAgICAgICAgICBsb3cgPSBtaWQgKyAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29tcCA+IDApIHtcbiAgICAgICAgICAgICAgICBoaWdoID0gbWlkIC0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBtaWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0obG93ICsgMSk7XG4gICAgfVxuICAgIHZzY01vY2tBcnJheXMuYmluYXJ5U2VhcmNoID0gYmluYXJ5U2VhcmNoO1xuICAgIC8qKlxuICAgICAqIFRha2VzIGEgc29ydGVkIGFycmF5IGFuZCBhIGZ1bmN0aW9uIHAuIFRoZSBhcnJheSBpcyBzb3J0ZWQgaW4gc3VjaCBhIHdheSB0aGF0IGFsbCBlbGVtZW50cyB3aGVyZSBwKHgpIGlzIGZhbHNlXG4gICAgICogYXJlIGxvY2F0ZWQgYmVmb3JlIGFsbCBlbGVtZW50cyB3aGVyZSBwKHgpIGlzIHRydWUuXG4gICAgICogQHJldHVybnMgdGhlIGxlYXN0IHggZm9yIHdoaWNoIHAoeCkgaXMgdHJ1ZSBvciBhcnJheS5sZW5ndGggaWYgbm8gZWxlbWVudCBmdWxsZmlsbHMgdGhlIGdpdmVuIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZpbmRGaXJzdChhcnJheSwgcCkge1xuICAgICAgICBsZXQgbG93ID0gMCwgaGlnaCA9IGFycmF5Lmxlbmd0aDtcbiAgICAgICAgaWYgKGhpZ2ggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiAwOyAvLyBubyBjaGlsZHJlblxuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChsb3cgPCBoaWdoKSB7XG4gICAgICAgICAgICBsZXQgbWlkID0gTWF0aC5mbG9vcigobG93ICsgaGlnaCkgLyAyKTtcbiAgICAgICAgICAgIGlmIChwKGFycmF5W21pZF0pKSB7XG4gICAgICAgICAgICAgICAgaGlnaCA9IG1pZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxvdyA9IG1pZCArIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxvdztcbiAgICB9XG4gICAgdnNjTW9ja0FycmF5cy5maW5kRmlyc3QgPSBmaW5kRmlyc3Q7XG4gICAgLyoqXG4gICAgICogTGlrZSBgQXJyYXkjc29ydGAgYnV0IGFsd2F5cyBzdGFibGUuIFVzdWFsbHkgcnVucyBhIGxpdHRsZSBzbG93ZXIgYHRoYW4gQXJyYXkjc29ydGBcbiAgICAgKiBzbyBvbmx5IHVzZSB0aGlzIHdoZW4gYWN0dWFsbHkgbmVlZGluZyBzdGFibGUgc29ydC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtZXJnZVNvcnQoZGF0YSwgY29tcGFyZSkge1xuICAgICAgICBfZGl2aWRlQW5kTWVyZ2UoZGF0YSwgY29tcGFyZSk7XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cbiAgICB2c2NNb2NrQXJyYXlzLm1lcmdlU29ydCA9IG1lcmdlU29ydDtcbiAgICBmdW5jdGlvbiBfZGl2aWRlQW5kTWVyZ2UoZGF0YSwgY29tcGFyZSkge1xuICAgICAgICBpZiAoZGF0YS5sZW5ndGggPD0gMSkge1xuICAgICAgICAgICAgLy8gc29ydGVkXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcCA9IChkYXRhLmxlbmd0aCAvIDIpIHwgMDtcbiAgICAgICAgY29uc3QgbGVmdCA9IGRhdGEuc2xpY2UoMCwgcCk7XG4gICAgICAgIGNvbnN0IHJpZ2h0ID0gZGF0YS5zbGljZShwKTtcbiAgICAgICAgX2RpdmlkZUFuZE1lcmdlKGxlZnQsIGNvbXBhcmUpO1xuICAgICAgICBfZGl2aWRlQW5kTWVyZ2UocmlnaHQsIGNvbXBhcmUpO1xuICAgICAgICBsZXQgbGVmdElkeCA9IDA7XG4gICAgICAgIGxldCByaWdodElkeCA9IDA7XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgd2hpbGUgKGxlZnRJZHggPCBsZWZ0Lmxlbmd0aCAmJiByaWdodElkeCA8IHJpZ2h0Lmxlbmd0aCkge1xuICAgICAgICAgICAgbGV0IHJldCA9IGNvbXBhcmUobGVmdFtsZWZ0SWR4XSwgcmlnaHRbcmlnaHRJZHhdKTtcbiAgICAgICAgICAgIGlmIChyZXQgPD0gMCkge1xuICAgICAgICAgICAgICAgIC8vIHNtYWxsZXJfZXF1YWwgLT4gdGFrZSBsZWZ0IHRvIHByZXNlcnZlIG9yZGVyXG4gICAgICAgICAgICAgICAgZGF0YVtpKytdID0gbGVmdFtsZWZ0SWR4KytdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZ3JlYXRlciAtPiB0YWtlIHJpZ2h0XG4gICAgICAgICAgICAgICAgZGF0YVtpKytdID0gcmlnaHRbcmlnaHRJZHgrK107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKGxlZnRJZHggPCBsZWZ0Lmxlbmd0aCkge1xuICAgICAgICAgICAgZGF0YVtpKytdID0gbGVmdFtsZWZ0SWR4KytdO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChyaWdodElkeCA8IHJpZ2h0Lmxlbmd0aCkge1xuICAgICAgICAgICAgZGF0YVtpKytdID0gcmlnaHRbcmlnaHRJZHgrK107XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gZ3JvdXBCeShkYXRhLCBjb21wYXJlKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xuICAgICAgICBsZXQgY3VycmVudEdyb3VwO1xuICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgbWVyZ2VTb3J0KGRhdGEuc2xpY2UoMCksIGNvbXBhcmUpKSB7XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRHcm91cCB8fCBjb21wYXJlKGN1cnJlbnRHcm91cFswXSwgZWxlbWVudCkgIT09IDApIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50R3JvdXAgPSBbZWxlbWVudF07XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goY3VycmVudEdyb3VwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cC5wdXNoKGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHZzY01vY2tBcnJheXMuZ3JvdXBCeSA9IGdyb3VwQnk7XG4gICAgLyoqXG4gICAgICogRGlmZnMgdHdvICpzb3J0ZWQqIGFycmF5cyBhbmQgY29tcHV0ZXMgdGhlIHNwbGljZXMgd2hpY2ggYXBwbHkgdGhlIGRpZmYuXG4gICAgICovXG4gICAgZnVuY3Rpb24gc29ydGVkRGlmZihiZWZvcmUsIGFmdGVyLCBjb21wYXJlKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xuICAgICAgICBmdW5jdGlvbiBwdXNoU3BsaWNlKHN0YXJ0LCBkZWxldGVDb3VudCwgdG9JbnNlcnQpIHtcbiAgICAgICAgICAgIGlmIChkZWxldGVDb3VudCA9PT0gMCAmJiB0b0luc2VydC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBsYXRlc3QgPSByZXN1bHRbcmVzdWx0Lmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgaWYgKGxhdGVzdCAmJiBsYXRlc3Quc3RhcnQgKyBsYXRlc3QuZGVsZXRlQ291bnQgPT09IHN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgbGF0ZXN0LmRlbGV0ZUNvdW50ICs9IGRlbGV0ZUNvdW50O1xuICAgICAgICAgICAgICAgIGxhdGVzdC50b0luc2VydC5wdXNoKC4uLnRvSW5zZXJ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHsgc3RhcnQsIGRlbGV0ZUNvdW50LCB0b0luc2VydCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsZXQgYmVmb3JlSWR4ID0gMDtcbiAgICAgICAgbGV0IGFmdGVySWR4ID0gMDtcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgIGlmIChiZWZvcmVJZHggPT09IGJlZm9yZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBwdXNoU3BsaWNlKGJlZm9yZUlkeCwgMCwgYWZ0ZXIuc2xpY2UoYWZ0ZXJJZHgpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhZnRlcklkeCA9PT0gYWZ0ZXIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcHVzaFNwbGljZShiZWZvcmVJZHgsIGJlZm9yZS5sZW5ndGggLSBiZWZvcmVJZHgsIFtdKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGJlZm9yZUVsZW1lbnQgPSBiZWZvcmVbYmVmb3JlSWR4XTtcbiAgICAgICAgICAgIGNvbnN0IGFmdGVyRWxlbWVudCA9IGFmdGVyW2FmdGVySWR4XTtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBjb21wYXJlKGJlZm9yZUVsZW1lbnQsIGFmdGVyRWxlbWVudCk7XG4gICAgICAgICAgICBpZiAobiA9PT0gMCkge1xuICAgICAgICAgICAgICAgIC8vIGVxdWFsXG4gICAgICAgICAgICAgICAgYmVmb3JlSWR4ICs9IDE7XG4gICAgICAgICAgICAgICAgYWZ0ZXJJZHggKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG4gPCAwKSB7XG4gICAgICAgICAgICAgICAgLy8gYmVmb3JlRWxlbWVudCBpcyBzbWFsbGVyIC0+IGJlZm9yZSBlbGVtZW50IHJlbW92ZWRcbiAgICAgICAgICAgICAgICBwdXNoU3BsaWNlKGJlZm9yZUlkeCwgMSwgW10pO1xuICAgICAgICAgICAgICAgIGJlZm9yZUlkeCArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobiA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBiZWZvcmVFbGVtZW50IGlzIGdyZWF0ZXIgLT4gYWZ0ZXIgZWxlbWVudCBhZGRlZFxuICAgICAgICAgICAgICAgIHB1c2hTcGxpY2UoYmVmb3JlSWR4LCAwLCBbYWZ0ZXJFbGVtZW50XSk7XG4gICAgICAgICAgICAgICAgYWZ0ZXJJZHggKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB2c2NNb2NrQXJyYXlzLnNvcnRlZERpZmYgPSBzb3J0ZWREaWZmO1xuICAgIC8qKlxuICAgICAqIFRha2VzIHR3byAqc29ydGVkKiBhcnJheXMgYW5kIGNvbXB1dGVzIHRoZWlyIGRlbHRhIChyZW1vdmVkLCBhZGRlZCBlbGVtZW50cykuXG4gICAgICogRmluaXNoZXMgaW4gYE1hdGgubWluKGJlZm9yZS5sZW5ndGgsIGFmdGVyLmxlbmd0aClgIHN0ZXBzLlxuICAgICAqIEBwYXJhbSBiZWZvcmVcbiAgICAgKiBAcGFyYW0gYWZ0ZXJcbiAgICAgKiBAcGFyYW0gY29tcGFyZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGRlbHRhKGJlZm9yZSwgYWZ0ZXIsIGNvbXBhcmUpIHtcbiAgICAgICAgY29uc3Qgc3BsaWNlcyA9IHNvcnRlZERpZmYoYmVmb3JlLCBhZnRlciwgY29tcGFyZSk7XG4gICAgICAgIGNvbnN0IHJlbW92ZWQgPSBbXTtcbiAgICAgICAgY29uc3QgYWRkZWQgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBzcGxpY2Ugb2Ygc3BsaWNlcykge1xuICAgICAgICAgICAgcmVtb3ZlZC5wdXNoKC4uLmJlZm9yZS5zbGljZShzcGxpY2Uuc3RhcnQsIHNwbGljZS5zdGFydCArIHNwbGljZS5kZWxldGVDb3VudCkpO1xuICAgICAgICAgICAgYWRkZWQucHVzaCguLi5zcGxpY2UudG9JbnNlcnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHJlbW92ZWQsIGFkZGVkIH07XG4gICAgfVxuICAgIHZzY01vY2tBcnJheXMuZGVsdGEgPSBkZWx0YTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB0b3AgTiBlbGVtZW50cyBmcm9tIHRoZSBhcnJheS5cbiAgICAgKlxuICAgICAqIEZhc3RlciB0aGFuIHNvcnRpbmcgdGhlIGVudGlyZSBhcnJheSB3aGVuIHRoZSBhcnJheSBpcyBhIGxvdCBsYXJnZXIgdGhhbiBOLlxuICAgICAqXG4gICAgICogQHBhcmFtIGFycmF5IFRoZSB1bnNvcnRlZCBhcnJheS5cbiAgICAgKiBAcGFyYW0gY29tcGFyZSBBIHNvcnQgZnVuY3Rpb24gZm9yIHRoZSBlbGVtZW50cy5cbiAgICAgKiBAcGFyYW0gbiBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIHRvIHJldHVybi5cbiAgICAgKiBAcmV0dXJuIFRoZSBmaXJzdCBuIGVsZW1udHMgZnJvbSBhcnJheSB3aGVuIHNvcnRlZCB3aXRoIGNvbXBhcmUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gdG9wKGFycmF5LCBjb21wYXJlLCBuKSB7XG4gICAgICAgIGlmIChuID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXJyYXkuc2xpY2UoMCwgbikuc29ydChjb21wYXJlKTtcbiAgICAgICAgdG9wU3RlcChhcnJheSwgY29tcGFyZSwgcmVzdWx0LCBuLCBhcnJheS5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB2c2NNb2NrQXJyYXlzLnRvcCA9IHRvcDtcbiAgICBmdW5jdGlvbiB0b3BTdGVwKGFycmF5LCBjb21wYXJlLCByZXN1bHQsIGksIG0pIHtcbiAgICAgICAgZm9yIChjb25zdCBuID0gcmVzdWx0Lmxlbmd0aDsgaSA8IG07IGkrKykge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGFycmF5W2ldO1xuICAgICAgICAgICAgaWYgKGNvbXBhcmUoZWxlbWVudCwgcmVzdWx0W24gLSAxXSkgPCAwKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnBvcCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGogPSBmaW5kRmlyc3QocmVzdWx0LCBlID0+IGNvbXBhcmUoZWxlbWVudCwgZSkgPCAwKTtcbiAgICAgICAgICAgICAgICByZXN1bHQuc3BsaWNlKGosIDAsIGVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIGEgbmV3IGFycmF5IHdpdGggYWxsIHVuZGVmaW5lZCBvciBudWxsIHZhbHVlcyByZW1vdmVkLiBUaGUgb3JpZ2luYWwgYXJyYXkgaXMgbm90IG1vZGlmaWVkIGF0IGFsbC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb2FsZXNjZShhcnJheSkge1xuICAgICAgICBpZiAoIWFycmF5KSB7XG4gICAgICAgICAgICByZXR1cm4gYXJyYXk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycmF5LmZpbHRlcihlID0+ICEhZSk7XG4gICAgfVxuICAgIHZzY01vY2tBcnJheXMuY29hbGVzY2UgPSBjb2FsZXNjZTtcbiAgICAvKipcbiAgICAgKiBNb3ZlcyB0aGUgZWxlbWVudCBpbiB0aGUgYXJyYXkgZm9yIHRoZSBwcm92aWRlZCBwb3NpdGlvbnMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gbW92ZShhcnJheSwgZnJvbSwgdG8pIHtcbiAgICAgICAgYXJyYXkuc3BsaWNlKHRvLCAwLCBhcnJheS5zcGxpY2UoZnJvbSwgMSlbMF0pO1xuICAgIH1cbiAgICB2c2NNb2NrQXJyYXlzLm1vdmUgPSBtb3ZlO1xuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHt7ZmFsc2V9fSBpZiB0aGUgcHJvdmlkZWQgb2JqZWN0IGlzIGFuIGFycmF5XG4gICAgICogXHRhbmQgbm90IGVtcHR5LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzRmFsc3lPckVtcHR5KG9iaikge1xuICAgICAgICByZXR1cm4gIUFycmF5LmlzQXJyYXkob2JqKSB8fCBvYmoubGVuZ3RoID09PSAwO1xuICAgIH1cbiAgICB2c2NNb2NrQXJyYXlzLmlzRmFsc3lPckVtcHR5ID0gaXNGYWxzeU9yRW1wdHk7XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBkdXBsaWNhdGVzIGZyb20gdGhlIGdpdmVuIGFycmF5LiBUaGUgb3B0aW9uYWwga2V5Rm4gYWxsb3dzIHRvIHNwZWNpZnlcbiAgICAgKiBob3cgZWxlbWVudHMgYXJlIGNoZWNrZWQgZm9yIGVxdWFsbmVzcyBieSByZXR1cm5pbmcgYSB1bmlxdWUgc3RyaW5nIGZvciBlYWNoLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGRpc3RpbmN0KGFycmF5LCBrZXlGbikge1xuICAgICAgICBpZiAoIWtleUZuKSB7XG4gICAgICAgICAgICByZXR1cm4gYXJyYXkuZmlsdGVyKChlbGVtZW50LCBwb3NpdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBhcnJheS5pbmRleE9mKGVsZW1lbnQpID09PSBwb3NpdGlvbjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNlZW4gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICByZXR1cm4gYXJyYXkuZmlsdGVyKChlbGVtKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBrZXkgPSBrZXlGbihlbGVtKTtcbiAgICAgICAgICAgIGlmIChzZWVuW2tleV0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWVuW2tleV0gPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB2c2NNb2NrQXJyYXlzLmRpc3RpbmN0ID0gZGlzdGluY3Q7XG4gICAgZnVuY3Rpb24gdW5pcXVlRmlsdGVyKGtleUZuKSB7XG4gICAgICAgIGNvbnN0IHNlZW4gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuICAgICAgICByZXR1cm4gZWxlbWVudCA9PiB7XG4gICAgICAgICAgICBjb25zdCBrZXkgPSBrZXlGbihlbGVtZW50KTtcbiAgICAgICAgICAgIGlmIChzZWVuW2tleV0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWVuW2tleV0gPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgfVxuICAgIHZzY01vY2tBcnJheXMudW5pcXVlRmlsdGVyID0gdW5pcXVlRmlsdGVyO1xuICAgIGZ1bmN0aW9uIGZpcnN0SW5kZXgoYXJyYXksIGZuKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBhcnJheVtpXTtcbiAgICAgICAgICAgIGlmIChmbihlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgdnNjTW9ja0FycmF5cy5maXJzdEluZGV4ID0gZmlyc3RJbmRleDtcbiAgICBmdW5jdGlvbiBmaXJzdChhcnJheSwgZm4sIG5vdEZvdW5kVmFsdWUgPSBudWxsKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gZmlyc3RJbmRleChhcnJheSwgZm4pO1xuICAgICAgICByZXR1cm4gaW5kZXggPCAwID8gbm90Rm91bmRWYWx1ZSA6IGFycmF5W2luZGV4XTtcbiAgICB9XG4gICAgdnNjTW9ja0FycmF5cy5maXJzdCA9IGZpcnN0O1xuICAgIGZ1bmN0aW9uIGNvbW1vblByZWZpeExlbmd0aChvbmUsIG90aGVyLCBlcXVhbHMgPSAoYSwgYikgPT4gYSA9PT0gYikge1xuICAgICAgICBsZXQgcmVzdWx0ID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IE1hdGgubWluKG9uZS5sZW5ndGgsIG90aGVyLmxlbmd0aCk7IGkgPCBsZW4gJiYgZXF1YWxzKG9uZVtpXSwgb3RoZXJbaV0pOyBpKyspIHtcbiAgICAgICAgICAgIHJlc3VsdCsrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHZzY01vY2tBcnJheXMuY29tbW9uUHJlZml4TGVuZ3RoID0gY29tbW9uUHJlZml4TGVuZ3RoO1xuICAgIGZ1bmN0aW9uIGZsYXR0ZW4oYXJyKSB7XG4gICAgICAgIHJldHVybiBbXS5jb25jYXQoLi4uYXJyKTtcbiAgICB9XG4gICAgdnNjTW9ja0FycmF5cy5mbGF0dGVuID0gZmxhdHRlbjtcbiAgICBmdW5jdGlvbiByYW5nZShhcmcsIHRvKSB7XG4gICAgICAgIGxldCBmcm9tID0gdHlwZW9mIHRvID09PSAnbnVtYmVyJyA/IGFyZyA6IDA7XG4gICAgICAgIGlmICh0eXBlb2YgdG8gPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICBmcm9tID0gYXJnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZnJvbSA9IDA7XG4gICAgICAgICAgICB0byA9IGFyZztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgaWYgKGZyb20gPD0gdG8pIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSBmcm9tOyBpIDwgdG87IGkrKykge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IGZyb207IGkgPiB0bzsgaS0tKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdnNjTW9ja0FycmF5cy5yYW5nZSA9IHJhbmdlO1xuICAgIGZ1bmN0aW9uIGZpbGwobnVtLCB2YWx1ZUZuLCBhcnIgPSBbXSkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bTsgaSsrKSB7XG4gICAgICAgICAgICBhcnJbaV0gPSB2YWx1ZUZuKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycjtcbiAgICB9XG4gICAgdnNjTW9ja0FycmF5cy5maWxsID0gZmlsbDtcbiAgICBmdW5jdGlvbiBpbmRleChhcnJheSwgaW5kZXhlciwgbWVyZ2VyID0gdCA9PiB0KSB7XG4gICAgICAgIHJldHVybiBhcnJheS5yZWR1Y2UoKHIsIHQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IGluZGV4ZXIodCk7XG4gICAgICAgICAgICByW2tleV0gPSBtZXJnZXIodCwgcltrZXldKTtcbiAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICB9LCBPYmplY3QuY3JlYXRlKG51bGwpKTtcbiAgICB9XG4gICAgdnNjTW9ja0FycmF5cy5pbmRleCA9IGluZGV4O1xuICAgIC8qKlxuICAgICAqIEluc2VydHMgYW4gZWxlbWVudCBpbnRvIGFuIGFycmF5LiBSZXR1cm5zIGEgZnVuY3Rpb24gd2hpY2gsIHdoZW5cbiAgICAgKiBjYWxsZWQsIHdpbGwgcmVtb3ZlIHRoYXQgZWxlbWVudCBmcm9tIHRoZSBhcnJheS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpbnNlcnQoYXJyYXksIGVsZW1lbnQpIHtcbiAgICAgICAgYXJyYXkucHVzaChlbGVtZW50KTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gYXJyYXkuaW5kZXhPZihlbGVtZW50KTtcbiAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgYXJyYXkuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgdnNjTW9ja0FycmF5cy5pbnNlcnQgPSBpbnNlcnQ7XG4gICAgLyoqXG4gICAgICogSW5zZXJ0IGBpbnNlcnRBcnJgIGluc2lkZSBgdGFyZ2V0YCBhdCBgaW5zZXJ0SW5kZXhgLlxuICAgICAqIFBsZWFzZSBkb24ndCB0b3VjaCB1bmxlc3MgeW91IHVuZGVyc3RhbmQgaHR0cHM6Ly9qc3BlcmYuY29tL2luc2VydGluZy1hbi1hcnJheS13aXRoaW4tYW4tYXJyYXlcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhcnJheUluc2VydCh0YXJnZXQsIGluc2VydEluZGV4LCBpbnNlcnRBcnIpIHtcbiAgICAgICAgY29uc3QgYmVmb3JlID0gdGFyZ2V0LnNsaWNlKDAsIGluc2VydEluZGV4KTtcbiAgICAgICAgY29uc3QgYWZ0ZXIgPSB0YXJnZXQuc2xpY2UoaW5zZXJ0SW5kZXgpO1xuICAgICAgICByZXR1cm4gYmVmb3JlLmNvbmNhdChpbnNlcnRBcnIsIGFmdGVyKTtcbiAgICB9XG4gICAgdnNjTW9ja0FycmF5cy5hcnJheUluc2VydCA9IGFycmF5SW5zZXJ0O1xufSkodnNjTW9ja0FycmF5cyA9IGV4cG9ydHMudnNjTW9ja0FycmF5cyB8fCAoZXhwb3J0cy52c2NNb2NrQXJyYXlzID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFycmF5cy5qcy5tYXAiXX0=