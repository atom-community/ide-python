/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
}); // tslint:disable:all

const position_1 = require("./position");

const range_1 = require("./range");

var vscMockSelection;

(function (vscMockSelection) {
  /**
   * The direction of a selection.
   */
  let SelectionDirection;

  (function (SelectionDirection) {
    /**
     * The selection starts above where it ends.
     */
    SelectionDirection[SelectionDirection["LTR"] = 0] = "LTR";
    /**
     * The selection starts below where it ends.
     */

    SelectionDirection[SelectionDirection["RTL"] = 1] = "RTL";
  })(SelectionDirection = vscMockSelection.SelectionDirection || (vscMockSelection.SelectionDirection = {}));
  /**
   * A selection in the editor.
   * The selection is a range that has an orientation.
   */


  class Selection extends range_1.vscMockRange.Range {
    constructor(selectionStartLineNumber, selectionStartColumn, positionLineNumber, positionColumn) {
      super(selectionStartLineNumber, selectionStartColumn, positionLineNumber, positionColumn);
      this.selectionStartLineNumber = selectionStartLineNumber;
      this.selectionStartColumn = selectionStartColumn;
      this.positionLineNumber = positionLineNumber;
      this.positionColumn = positionColumn;
    }
    /**
     * Clone this selection.
     */


    clone() {
      return new Selection(this.selectionStartLineNumber, this.selectionStartColumn, this.positionLineNumber, this.positionColumn);
    }
    /**
     * Transform to a human-readable representation.
     */


    toString() {
      return '[' + this.selectionStartLineNumber + ',' + this.selectionStartColumn + ' -> ' + this.positionLineNumber + ',' + this.positionColumn + ']';
    }
    /**
     * Test if equals other selection.
     */


    equalsSelection(other) {
      return Selection.selectionsEqual(this, other);
    }
    /**
     * Test if the two selections are equal.
     */


    static selectionsEqual(a, b) {
      return a.selectionStartLineNumber === b.selectionStartLineNumber && a.selectionStartColumn === b.selectionStartColumn && a.positionLineNumber === b.positionLineNumber && a.positionColumn === b.positionColumn;
    }
    /**
     * Get directions (LTR or RTL).
     */


    getDirection() {
      if (this.selectionStartLineNumber === this.startLineNumber && this.selectionStartColumn === this.startColumn) {
        return SelectionDirection.LTR;
      }

      return SelectionDirection.RTL;
    }
    /**
     * Create a new selection with a different `positionLineNumber` and `positionColumn`.
     */


    setEndPosition(endLineNumber, endColumn) {
      if (this.getDirection() === SelectionDirection.LTR) {
        return new Selection(this.startLineNumber, this.startColumn, endLineNumber, endColumn);
      }

      return new Selection(endLineNumber, endColumn, this.startLineNumber, this.startColumn);
    }
    /**
     * Get the position at `positionLineNumber` and `positionColumn`.
     */


    getPosition() {
      return new position_1.vscMockPosition.Position(this.positionLineNumber, this.positionColumn);
    }
    /**
     * Create a new selection with a different `selectionStartLineNumber` and `selectionStartColumn`.
     */


    setStartPosition(startLineNumber, startColumn) {
      if (this.getDirection() === SelectionDirection.LTR) {
        return new Selection(startLineNumber, startColumn, this.endLineNumber, this.endColumn);
      }

      return new Selection(this.endLineNumber, this.endColumn, startLineNumber, startColumn);
    } // ----

    /**
     * Create a `Selection` from one or two positions
     */


    static fromPositions(start, end = start) {
      return new Selection(start.lineNumber, start.column, end.lineNumber, end.column);
    }
    /**
     * Create a `Selection` from an `ISelection`.
     */


    static liftSelection(sel) {
      return new Selection(sel.selectionStartLineNumber, sel.selectionStartColumn, sel.positionLineNumber, sel.positionColumn);
    }
    /**
     * `a` equals `b`.
     */


    static selectionsArrEqual(a, b) {
      if (a && !b || !a && b) {
        return false;
      }

      if (!a && !b) {
        return true;
      }

      if (a.length !== b.length) {
        return false;
      }

      for (var i = 0, len = a.length; i < len; i++) {
        if (!this.selectionsEqual(a[i], b[i])) {
          return false;
        }
      }

      return true;
    }
    /**
     * Test if `obj` is an `ISelection`.
     */


    static isISelection(obj) {
      return obj && typeof obj.selectionStartLineNumber === 'number' && typeof obj.selectionStartColumn === 'number' && typeof obj.positionLineNumber === 'number' && typeof obj.positionColumn === 'number';
    }
    /**
     * Create with a direction.
     */


    static createWithDirection(startLineNumber, startColumn, endLineNumber, endColumn, direction) {
      if (direction === SelectionDirection.LTR) {
        return new Selection(startLineNumber, startColumn, endLineNumber, endColumn);
      }

      return new Selection(endLineNumber, endColumn, startLineNumber, startColumn);
    }

  }

  vscMockSelection.Selection = Selection;
})(vscMockSelection = exports.vscMockSelection || (exports.vscMockSelection = {}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlbGVjdGlvbi5qcyJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsInBvc2l0aW9uXzEiLCJyZXF1aXJlIiwicmFuZ2VfMSIsInZzY01vY2tTZWxlY3Rpb24iLCJTZWxlY3Rpb25EaXJlY3Rpb24iLCJTZWxlY3Rpb24iLCJ2c2NNb2NrUmFuZ2UiLCJSYW5nZSIsImNvbnN0cnVjdG9yIiwic2VsZWN0aW9uU3RhcnRMaW5lTnVtYmVyIiwic2VsZWN0aW9uU3RhcnRDb2x1bW4iLCJwb3NpdGlvbkxpbmVOdW1iZXIiLCJwb3NpdGlvbkNvbHVtbiIsImNsb25lIiwidG9TdHJpbmciLCJlcXVhbHNTZWxlY3Rpb24iLCJvdGhlciIsInNlbGVjdGlvbnNFcXVhbCIsImEiLCJiIiwiZ2V0RGlyZWN0aW9uIiwic3RhcnRMaW5lTnVtYmVyIiwic3RhcnRDb2x1bW4iLCJMVFIiLCJSVEwiLCJzZXRFbmRQb3NpdGlvbiIsImVuZExpbmVOdW1iZXIiLCJlbmRDb2x1bW4iLCJnZXRQb3NpdGlvbiIsInZzY01vY2tQb3NpdGlvbiIsIlBvc2l0aW9uIiwic2V0U3RhcnRQb3NpdGlvbiIsImZyb21Qb3NpdGlvbnMiLCJzdGFydCIsImVuZCIsImxpbmVOdW1iZXIiLCJjb2x1bW4iLCJsaWZ0U2VsZWN0aW9uIiwic2VsIiwic2VsZWN0aW9uc0FyckVxdWFsIiwibGVuZ3RoIiwiaSIsImxlbiIsImlzSVNlbGVjdGlvbiIsIm9iaiIsImNyZWF0ZVdpdGhEaXJlY3Rpb24iLCJkaXJlY3Rpb24iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0FBLE1BQU0sQ0FBQ0MsY0FBUCxDQUFzQkMsT0FBdEIsRUFBK0IsWUFBL0IsRUFBNkM7QUFBRUMsRUFBQUEsS0FBSyxFQUFFO0FBQVQsQ0FBN0MsRSxDQUNBOztBQUNBLE1BQU1DLFVBQVUsR0FBR0MsT0FBTyxDQUFDLFlBQUQsQ0FBMUI7O0FBQ0EsTUFBTUMsT0FB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QThCLFFBSnRDO0FBS0g7QUFDRDtBQUNSO0FBQ0E7OztBQUNrQyxXQUFuQmlDLG1CQUFtQixDQUFDeEIsZUFBRCxFQUFrQkMsV0FBbEIsRUFBK0JJLGFBQS9CLEVBQThDQyxTQUE5QyxFQUF5RG1CLFNBQXpELEVBQW9FO0FBQzFGLFVBQUlBLFNBQVMsS0FBSzFDLGtCQUFrQixDQUFDbUIsR0FBckMsRUFBMEM7QUFDdEMsZUFBTyxJQUFJbEIsU0FBSixDQUFjZ0IsZUFBZCxFQUErQkMsV0FBL0IsRUFBNENJLGFBQTVDLEVBQTJEQyxTQUEzRCxDQUFQO0FBQ0g7O0FBQ0QsYUFBTyxJQUFJdEIsU0FBSixDQUFjcUIsYUFBZCxFQUE2QkMsU0FBN0IsRUFBd0NOLGVBQXhDLEVBQXlEQyxXQUF6RCxDQUFQO0FBQ0g7O0FBdkg4Qzs7QUF5SG5EbkIsRUFBQUEsZ0JBQWdCLENBQUNFLFNBQWpCLEdBQTZCQSxTQUE3QjtBQUNILENBN0lELEVBNklHRixnQkFBZ0IsR0FBR0wsT0FBTyxDQUFDSyxnQkFBUixLQUE2QkwsT0FBTyxDQUFDSyxnQkFBUixHQUEyQixFQUF4RCxDQTdJdEIiLCJzb3VyY2VzQ29udGVudCI6WyIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbid1c2Ugc3RyaWN0Jztcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8vIHRzbGludDpkaXNhYmxlOmFsbFxuY29uc3QgcG9zaXRpb25fMSA9IHJlcXVpcmUoXCIuL3Bvc2l0aW9uXCIpO1xuY29uc3QgcmFuZ2VfMSA9IHJlcXVpcmUoXCIuL3JhbmdlXCIpO1xudmFyIHZzY01vY2tTZWxlY3Rpb247XG4oZnVuY3Rpb24gKHZzY01vY2tTZWxlY3Rpb24pIHtcbiAgICAvKipcbiAgICAgKiBUaGUgZGlyZWN0aW9uIG9mIGEgc2VsZWN0aW9uLlxuICAgICAqL1xuICAgIGxldCBTZWxlY3Rpb25EaXJlY3Rpb247XG4gICAgKGZ1bmN0aW9uIChTZWxlY3Rpb25EaXJlY3Rpb24pIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzZWxlY3Rpb24gc3RhcnRzIGFib3ZlIHdoZXJlIGl0IGVuZHMuXG4gICAgICAgICAqL1xuICAgICAgICBTZWxlY3Rpb25EaXJlY3Rpb25bU2VsZWN0aW9uRGlyZWN0aW9uW1wiTFRSXCJdID0gMF0gPSBcIkxUUlwiO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHNlbGVjdGlvbiBzdGFydHMgYmVsb3cgd2hlcmUgaXQgZW5kcy5cbiAgICAgICAgICovXG4gICAgICAgIFNlbGVjdGlvbkRpcmVjdGlvbltTZWxlY3Rpb25EaXJlY3Rpb25bXCJSVExcIl0gPSAxXSA9IFwiUlRMXCI7XG4gICAgfSkoU2VsZWN0aW9uRGlyZWN0aW9uID0gdnNjTW9ja1NlbGVjdGlvbi5TZWxlY3Rpb25EaXJlY3Rpb24gfHwgKHZzY01vY2tTZWxlY3Rpb24uU2VsZWN0aW9uRGlyZWN0aW9uID0ge30pKTtcbiAgICAvKipcbiAgICAgKiBBIHNlbGVjdGlvbiBpbiB0aGUgZWRpdG9yLlxuICAgICAqIFRoZSBzZWxlY3Rpb24gaXMgYSByYW5nZSB0aGF0IGhhcyBhbiBvcmllbnRhdGlvbi5cbiAgICAgKi9cbiAgICBjbGFzcyBTZWxlY3Rpb24gZXh0ZW5kcyByYW5nZV8xLnZzY01vY2tSYW5nZS5SYW5nZSB7XG4gICAgICAgIGNvbnN0cnVjdG9yKHNlbGVjdGlvblN0YXJ0TGluZU51bWJlciwgc2VsZWN0aW9uU3RhcnRDb2x1bW4sIHBvc2l0aW9uTGluZU51bWJlciwgcG9zaXRpb25Db2x1bW4pIHtcbiAgICAgICAgICAgIHN1cGVyKHNlbGVjdGlvblN0YXJ0TGluZU51bWJlciwgc2VsZWN0aW9uU3RhcnRDb2x1bW4sIHBvc2l0aW9uTGluZU51bWJlciwgcG9zaXRpb25Db2x1bW4pO1xuICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25TdGFydExpbmVOdW1iZXIgPSBzZWxlY3Rpb25TdGFydExpbmVOdW1iZXI7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGlvblN0YXJ0Q29sdW1uID0gc2VsZWN0aW9uU3RhcnRDb2x1bW47XG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uTGluZU51bWJlciA9IHBvc2l0aW9uTGluZU51bWJlcjtcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb25Db2x1bW4gPSBwb3NpdGlvbkNvbHVtbjtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogQ2xvbmUgdGhpcyBzZWxlY3Rpb24uXG4gICAgICAgICAqL1xuICAgICAgICBjbG9uZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgU2VsZWN0aW9uKHRoaXMuc2VsZWN0aW9uU3RhcnRMaW5lTnVtYmVyLCB0aGlzLnNlbGVjdGlvblN0YXJ0Q29sdW1uLCB0aGlzLnBvc2l0aW9uTGluZU51bWJlciwgdGhpcy5wb3NpdGlvbkNvbHVtbik7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRyYW5zZm9ybSB0byBhIGh1bWFuLXJlYWRhYmxlIHJlcHJlc2VudGF0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgdG9TdHJpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ1snICsgdGhpcy5zZWxlY3Rpb25TdGFydExpbmVOdW1iZXIgKyAnLCcgKyB0aGlzLnNlbGVjdGlvblN0YXJ0Q29sdW1uICsgJyAtPiAnICsgdGhpcy5wb3NpdGlvbkxpbmVOdW1iZXIgKyAnLCcgKyB0aGlzLnBvc2l0aW9uQ29sdW1uICsgJ10nO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUZXN0IGlmIGVxdWFscyBvdGhlciBzZWxlY3Rpb24uXG4gICAgICAgICAqL1xuICAgICAgICBlcXVhbHNTZWxlY3Rpb24ob3RoZXIpIHtcbiAgICAgICAgICAgIHJldHVybiAoU2VsZWN0aW9uLnNlbGVjdGlvbnNFcXVhbCh0aGlzLCBvdGhlcikpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUZXN0IGlmIHRoZSB0d28gc2VsZWN0aW9ucyBhcmUgZXF1YWwuXG4gICAgICAgICAqL1xuICAgICAgICBzdGF0aWMgc2VsZWN0aW9uc0VxdWFsKGEsIGIpIHtcbiAgICAgICAgICAgIHJldHVybiAoYS5zZWxlY3Rpb25TdGFydExpbmVOdW1iZXIgPT09IGIuc2VsZWN0aW9uU3RhcnRMaW5lTnVtYmVyICYmXG4gICAgICAgICAgICAgICAgYS5zZWxlY3Rpb25TdGFydENvbHVtbiA9PT0gYi5zZWxlY3Rpb25TdGFydENvbHVtbiAmJlxuICAgICAgICAgICAgICAgIGEucG9zaXRpb25MaW5lTnVtYmVyID09PSBiLnBvc2l0aW9uTGluZU51bWJlciAmJlxuICAgICAgICAgICAgICAgIGEucG9zaXRpb25Db2x1bW4gPT09IGIucG9zaXRpb25Db2x1bW4pO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgZGlyZWN0aW9ucyAoTFRSIG9yIFJUTCkuXG4gICAgICAgICAqL1xuICAgICAgICBnZXREaXJlY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25TdGFydExpbmVOdW1iZXIgPT09IHRoaXMuc3RhcnRMaW5lTnVtYmVyICYmIHRoaXMuc2VsZWN0aW9uU3RhcnRDb2x1bW4gPT09IHRoaXMuc3RhcnRDb2x1bW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gU2VsZWN0aW9uRGlyZWN0aW9uLkxUUjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBTZWxlY3Rpb25EaXJlY3Rpb24uUlRMO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDcmVhdGUgYSBuZXcgc2VsZWN0aW9uIHdpdGggYSBkaWZmZXJlbnQgYHBvc2l0aW9uTGluZU51bWJlcmAgYW5kIGBwb3NpdGlvbkNvbHVtbmAuXG4gICAgICAgICAqL1xuICAgICAgICBzZXRFbmRQb3NpdGlvbihlbmRMaW5lTnVtYmVyLCBlbmRDb2x1bW4pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldERpcmVjdGlvbigpID09PSBTZWxlY3Rpb25EaXJlY3Rpb24uTFRSKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTZWxlY3Rpb24odGhpcy5zdGFydExpbmVOdW1iZXIsIHRoaXMuc3RhcnRDb2x1bW4sIGVuZExpbmVOdW1iZXIsIGVuZENvbHVtbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IFNlbGVjdGlvbihlbmRMaW5lTnVtYmVyLCBlbmRDb2x1bW4sIHRoaXMuc3RhcnRMaW5lTnVtYmVyLCB0aGlzLnN0YXJ0Q29sdW1uKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHRoZSBwb3NpdGlvbiBhdCBgcG9zaXRpb25MaW5lTnVtYmVyYCBhbmQgYHBvc2l0aW9uQ29sdW1uYC5cbiAgICAgICAgICovXG4gICAgICAgIGdldFBvc2l0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBwb3NpdGlvbl8xLnZzY01vY2tQb3NpdGlvbi5Qb3NpdGlvbih0aGlzLnBvc2l0aW9uTGluZU51bWJlciwgdGhpcy5wb3NpdGlvbkNvbHVtbik7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENyZWF0ZSBhIG5ldyBzZWxlY3Rpb24gd2l0aCBhIGRpZmZlcmVudCBgc2VsZWN0aW9uU3RhcnRMaW5lTnVtYmVyYCBhbmQgYHNlbGVjdGlvblN0YXJ0Q29sdW1uYC5cbiAgICAgICAgICovXG4gICAgICAgIHNldFN0YXJ0UG9zaXRpb24oc3RhcnRMaW5lTnVtYmVyLCBzdGFydENvbHVtbikge1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0RGlyZWN0aW9uKCkgPT09IFNlbGVjdGlvbkRpcmVjdGlvbi5MVFIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFNlbGVjdGlvbihzdGFydExpbmVOdW1iZXIsIHN0YXJ0Q29sdW1uLCB0aGlzLmVuZExpbmVOdW1iZXIsIHRoaXMuZW5kQ29sdW1uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgU2VsZWN0aW9uKHRoaXMuZW5kTGluZU51bWJlciwgdGhpcy5lbmRDb2x1bW4sIHN0YXJ0TGluZU51bWJlciwgc3RhcnRDb2x1bW4pO1xuICAgICAgICB9XG4gICAgICAgIC8vIC0tLS1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENyZWF0ZSBhIGBTZWxlY3Rpb25gIGZyb20gb25lIG9yIHR3byBwb3NpdGlvbnNcbiAgICAgICAgICovXG4gICAgICAgIHN0YXRpYyBmcm9tUG9zaXRpb25zKHN0YXJ0LCBlbmQgPSBzdGFydCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBTZWxlY3Rpb24oc3RhcnQubGluZU51bWJlciwgc3RhcnQuY29sdW1uLCBlbmQubGluZU51bWJlciwgZW5kLmNvbHVtbik7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENyZWF0ZSBhIGBTZWxlY3Rpb25gIGZyb20gYW4gYElTZWxlY3Rpb25gLlxuICAgICAgICAgKi9cbiAgICAgICAgc3RhdGljIGxpZnRTZWxlY3Rpb24oc2VsKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFNlbGVjdGlvbihzZWwuc2VsZWN0aW9uU3RhcnRMaW5lTnVtYmVyLCBzZWwuc2VsZWN0aW9uU3RhcnRDb2x1bW4sIHNlbC5wb3NpdGlvbkxpbmVOdW1iZXIsIHNlbC5wb3NpdGlvbkNvbHVtbik7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGBhYCBlcXVhbHMgYGJgLlxuICAgICAgICAgKi9cbiAgICAgICAgc3RhdGljIHNlbGVjdGlvbnNBcnJFcXVhbChhLCBiKSB7XG4gICAgICAgICAgICBpZiAoYSAmJiAhYiB8fCAhYSAmJiBiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFhICYmICFiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGEubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2VsZWN0aW9uc0VxdWFsKGFbaV0sIGJbaV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogVGVzdCBpZiBgb2JqYCBpcyBhbiBgSVNlbGVjdGlvbmAuXG4gICAgICAgICAqL1xuICAgICAgICBzdGF0aWMgaXNJU2VsZWN0aW9uKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIChvYmpcbiAgICAgICAgICAgICAgICAmJiAodHlwZW9mIG9iai5zZWxlY3Rpb25TdGFydExpbmVOdW1iZXIgPT09ICdudW1iZXInKVxuICAgICAgICAgICAgICAgICYmICh0eXBlb2Ygb2JqLnNlbGVjdGlvblN0YXJ0Q29sdW1uID09PSAnbnVtYmVyJylcbiAgICAgICAgICAgICAgICAmJiAodHlwZW9mIG9iai5wb3NpdGlvbkxpbmVOdW1iZXIgPT09ICdudW1iZXInKVxuICAgICAgICAgICAgICAgICYmICh0eXBlb2Ygb2JqLnBvc2l0aW9uQ29sdW1uID09PSAnbnVtYmVyJykpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDcmVhdGUgd2l0aCBhIGRpcmVjdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIHN0YXRpYyBjcmVhdGVXaXRoRGlyZWN0aW9uKHN0YXJ0TGluZU51bWJlciwgc3RhcnRDb2x1bW4sIGVuZExpbmVOdW1iZXIsIGVuZENvbHVtbiwgZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBpZiAoZGlyZWN0aW9uID09PSBTZWxlY3Rpb25EaXJlY3Rpb24uTFRSKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTZWxlY3Rpb24oc3RhcnRMaW5lTnVtYmVyLCBzdGFydENvbHVtbiwgZW5kTGluZU51bWJlciwgZW5kQ29sdW1uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgU2VsZWN0aW9uKGVuZExpbmVOdW1iZXIsIGVuZENvbHVtbiwgc3RhcnRMaW5lTnVtYmVyLCBzdGFydENvbHVtbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdnNjTW9ja1NlbGVjdGlvbi5TZWxlY3Rpb24gPSBTZWxlY3Rpb247XG59KSh2c2NNb2NrU2VsZWN0aW9uID0gZXhwb3J0cy52c2NNb2NrU2VsZWN0aW9uIHx8IChleHBvcnRzLnZzY01vY2tTZWxlY3Rpb24gPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VsZWN0aW9uLmpzLm1hcCJdfQ==