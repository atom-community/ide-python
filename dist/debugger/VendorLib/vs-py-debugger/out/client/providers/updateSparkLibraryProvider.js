'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

const path = require("path");

const vscode = require("vscode");

const constants_1 = require("../common/constants");

const telemetry_1 = require("../telemetry");

const constants_2 = require("../telemetry/constants");

function activateUpdateSparkLibraryProvider() {
  return vscode.commands.registerCommand(constants_1.Commands.Update_SparkLibrary, updateSparkLibrary);
}

exports.activateUpdateSparkLibraryProvider = activateUpdateSparkLibraryProvider;

function updateSparkLibrary() {
  const pythonConfig = vscode.workspace.getConfiguration('python');
  const extraLibPath = 'autoComplete.extraPaths'; // tslint:disable-next-line:no-invalid-template-strings

  const sparkHomePath = '${env:SPARK_HOME}';
  pythonConfig.update(extraLibPath, [path.join(sparkHomePath, 'python'), path.join(sparkHomePath, 'python/pyspark')]).then(() => {//Done
  }, reason => {
    vscode.window.showErrorMessage(`Failed to update ${extraLibPath}. Error: ${reason.message}`);
    console.error(reason);
  });
  vscode.window.showInformationMessage('Make sure you have SPARK_HOME environment variable set to the root path of the local spark installation!');
  telemetry_1.sendTelemetryEvent(constants_2.UPDATE_PYSPARK_LIBRARY);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVwZGF0ZVNwYXJrTGlicmFyeVByb3ZpZGVyLmpzIl0sIm5hbWVzIjpbIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwicGF0aCIsInJlcXVpcmUiLCJ2c2NvZGUiLCJjb25zdGFudHNfMSIsInRlbGVtZXRyeV8xIiwiY29uc3RhbnRzXzIiLCJhY3RpdmF0ZVVwZGF0ZVNwYXJrTGlicmFyeVByb3ZpZGVyIiwiY29tbWFuZHMiLCJyZWdpc3RlckNvbW1hbmQiLCJDb21tYW5kcyIsIlVwZGF0ZV9TcGFya0xpYnJhcnkiLCJ1cGRhdGVTcGFya0xpYnJhcnkiLCJweXRob25Db25maWciLCJ3b3Jrc3BhY2UiLCJnZXRDb25maWd1cmF0aW9uIiwiZXh0cmFMaWJQYXRoIiwic3BhcmtIb21lUGF0aCIsInVwZGF0ZSIsImpvaW4iLCJ0aGVuIiwicmVhc29uIiwid2luZG93Iiwic2hvd0Vycm9yTWVzc2FnZSIsIm1lc3NhZ2UiLCJjb25zb2xlIiwiZXJyb3IiLCJzaG93SW5mb3JtYXRpb25NZXNzYWdlIiwic2VuZFRlbGVtZXRyeUV2ZW50IiwiVVBEQVRFX1BZU1BBUktfTElCUkFSWSJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBQ0FBLE1BQU0sQ0FBQ0MsY0FBUCxDQUFzQkMsT0FBdEIsRUFBK0IsWUFBL0IsRUFBNkM7QUFBRUMsRUFBQUEsS0FBSyxFQUFFO0FBQVQsQ0FBN0M7O0FBQ0EsTUFBTUMsSUFBSSxHQUFHQyxPQUFPLENBQUMsTUFBRCxDQUFwQjs7QUFDQSxNQUFNQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyxRQUFELENBQXRCOztBQUNBLE1BQU1FLFdBQVcsR0FBR0YsT0FBTyxDQUFDLHFCQUFELENBQTNCOztBQUNBLE1BQU1HLFdBQVcsR0FBR0gsT0FBTyxDQUFDLGNBQUQsQ0FBM0I7O0FBQ0EsTUFBTUksV0FBVyxHQUFHSixPQUFPLENBQUMsd0JBQUQsQ0FBM0I7O0FBQ0EsU0FBU0ssa0NBQVQsR0FBOEM7QUFDMUMsU0FBT0osTUFBTSxDQUFDSyxRQUFQLENBQWdCQyxlQUFoQixDQUFnQ0wsV0FBVyxDQUFDTSxRQUFaLENBQXFCQyxtQkFBckQsRUFBMEVDLGtCQUExRSxDQUFQO0FBQ0g7O0FBQ0RiLE9BQU8sQ0FBQ1Esa0NBQVIsR0FBNkNBLGtDQUE3Qzs7QUFDQSxTQUFTSyxrQkFBVCxHQUE4QjtBQUMxQixRQUFNQyxZQUFZLEdBQUdWLE1BQU0sQ0FBQ1csU0FBUCxDQUFpQkMsZ0JBQWpCLENBQWtDLFFBQWxDLENBQXJCO0FBQ0EsUUFBTUMsWUFBWSxHQUFHLHlCQUFyQixDQUYwQixDQUcxQjs7QUFDQSxRQUFNQyxhQUFhLEdBQUcsbUJBQXRCO0FBQ0FKLEVBQUFBLFlBQVksQ0FBQ0ssTUFBYixDQUFvQkYsWUFBcEIsRUFBa0MsQ0FBQ2YsSUFBSSxDQUFDa0IsSUFBTCxDQUFVRixhQUFWLEVBQXlCLFFBQXpCLENBQUQsRUFDOUJoQixJQUFJLENBQUNrQixJQUFMLENBQVVGLGFBQVYsRUFBeUIsZ0JBQXpCLENBRDhCLENBQWxDLEVBQ2lERyxJQURqRCxDQUNzRCxNQUFNLENBQ3hEO0FBQ0gsR0FIRCxFQUdHQyxNQUFNLElBQUk7QUFDVGxCLElBQUFBLE1BQU0sQ0FBQ21CLE1BQVAsQ0FBY0MsZ0JBQWQsQ0FBZ0Msb0JBQW1CUCxZQUFhLFlBQVdLLE1BQU0sQ0FBQ0csT0FBUSxFQUExRjtBQUNBQyxJQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBY0wsTUFBZDtBQUNILEdBTkQ7QUFPQWxCLEVBQUFBLE1BQU0sQ0FBQ21CLE1BQVAsQ0FBY0ssc0JBQWQsQ0FBcUMsMEdBQXJDO0FBQ0F0QixFQUFBQSxXQUFXLENBQUN1QixrQkFBWixDQUErQnRCLFdBQVcsQ0FBQ3VCLHNCQUEzQztBQUNIIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3QgcGF0aCA9IHJlcXVpcmUoXCJwYXRoXCIpO1xuY29uc3QgdnNjb2RlID0gcmVxdWlyZShcInZzY29kZVwiKTtcbmNvbnN0IGNvbnN0YW50c18xID0gcmVxdWlyZShcIi4uL2NvbW1vbi9jb25zdGFudHNcIik7XG5jb25zdCB0ZWxlbWV0cnlfMSA9IHJlcXVpcmUoXCIuLi90ZWxlbWV0cnlcIik7XG5jb25zdCBjb25zdGFudHNfMiA9IHJlcXVpcmUoXCIuLi90ZWxlbWV0cnkvY29uc3RhbnRzXCIpO1xuZnVuY3Rpb24gYWN0aXZhdGVVcGRhdGVTcGFya0xpYnJhcnlQcm92aWRlcigpIHtcbiAgICByZXR1cm4gdnNjb2RlLmNvbW1hbmRzLnJlZ2lzdGVyQ29tbWFuZChjb25zdGFudHNfMS5Db21tYW5kcy5VcGRhdGVfU3BhcmtMaWJyYXJ5LCB1cGRhdGVTcGFya0xpYnJhcnkpO1xufVxuZXhwb3J0cy5hY3RpdmF0ZVVwZGF0ZVNwYXJrTGlicmFyeVByb3ZpZGVyID0gYWN0aXZhdGVVcGRhdGVTcGFya0xpYnJhcnlQcm92aWRlcjtcbmZ1bmN0aW9uIHVwZGF0ZVNwYXJrTGlicmFyeSgpIHtcbiAgICBjb25zdCBweXRob25Db25maWcgPSB2c2NvZGUud29ya3NwYWNlLmdldENvbmZpZ3VyYXRpb24oJ3B5dGhvbicpO1xuICAgIGNvbnN0IGV4dHJhTGliUGF0aCA9ICdhdXRvQ29tcGxldGUuZXh0cmFQYXRocyc7XG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWludmFsaWQtdGVtcGxhdGUtc3RyaW5nc1xuICAgIGNvbnN0IHNwYXJrSG9tZVBhdGggPSAnJHtlbnY6U1BBUktfSE9NRX0nO1xuICAgIHB5dGhvbkNvbmZpZy51cGRhdGUoZXh0cmFMaWJQYXRoLCBbcGF0aC5qb2luKHNwYXJrSG9tZVBhdGgsICdweXRob24nKSxcbiAgICAgICAgcGF0aC5qb2luKHNwYXJrSG9tZVBhdGgsICdweXRob24vcHlzcGFyaycpXSkudGhlbigoKSA9PiB7XG4gICAgICAgIC8vRG9uZVxuICAgIH0sIHJlYXNvbiA9PiB7XG4gICAgICAgIHZzY29kZS53aW5kb3cuc2hvd0Vycm9yTWVzc2FnZShgRmFpbGVkIHRvIHVwZGF0ZSAke2V4dHJhTGliUGF0aH0uIEVycm9yOiAke3JlYXNvbi5tZXNzYWdlfWApO1xuICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7XG4gICAgfSk7XG4gICAgdnNjb2RlLndpbmRvdy5zaG93SW5mb3JtYXRpb25NZXNzYWdlKCdNYWtlIHN1cmUgeW91IGhhdmUgU1BBUktfSE9NRSBlbnZpcm9ubWVudCB2YXJpYWJsZSBzZXQgdG8gdGhlIHJvb3QgcGF0aCBvZiB0aGUgbG9jYWwgc3BhcmsgaW5zdGFsbGF0aW9uIScpO1xuICAgIHRlbGVtZXRyeV8xLnNlbmRUZWxlbWV0cnlFdmVudChjb25zdGFudHNfMi5VUERBVEVfUFlTUEFSS19MSUJSQVJZKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXVwZGF0ZVNwYXJrTGlicmFyeVByb3ZpZGVyLmpzLm1hcCJdfQ==