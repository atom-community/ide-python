// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';

var __decorate = void 0 && (void 0).__decorate || function (decorators, target, key, desc) {
  var c = arguments.length,
      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,
      d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
  return c > 3 && r && Object.defineProperty(target, key, r), r;
};

var __param = void 0 && (void 0).__param || function (paramIndex, decorator) {
  return function (target, key) {
    decorator(target, key, paramIndex);
  };
};

Object.defineProperty(exports, "__esModule", {
  value: true
});

const inversify_1 = require("inversify");

const registry_1 = require("../../common/platform/registry");

const contracts_1 = require("../contracts");

let InterpreterComparer = class InterpreterComparer {
  constructor(interpreterHelper) {
    this.interpreterHelper = interpreterHelper;
  }

  compare(a, b) {
    const nameA = this.getSortName(a);
    const nameB = this.getSortName(b);

    if (nameA === nameB) {
      return 0;
    }

    return nameA > nameB ? 1 : -1;
  }

  getSortName(info) {
    const sortNameParts = [];
    const envSuffixParts = []; // Sort order for interpreters is:
    // * Version
    // * Architecture
    // * Interpreter Type
    // * Environment name

    if (info.version_info && info.version_info.length > 0) {
      sortNameParts.push(info.version_info.slice(0, 3).join('.'));
    }

    if (info.architecture) {
      sortNameParts.push(registry_1.getArchitectureDisplayName(info.architecture));
    }

    if (info.companyDisplayName && info.companyDisplayName.length > 0) {
      sortNameParts.push(info.companyDisplayName.trim());
    } else {
      sortNameParts.push('Python');
    }

    if (info.type) {
      const name = this.interpreterHelper.getInterpreterTypeDisplayName(info.type);

      if (name) {
        envSuffixParts.push(name);
      }
    }

    if (info.envName && info.envName.length > 0) {
      envSuffixParts.push(info.envName);
    }

    const envSuffix = envSuffixParts.length === 0 ? '' : `(${envSuffixParts.join(': ')})`;
    return `${sortNameParts.join(' ')} ${envSuffix}`.trim();
  }

};
InterpreterComparer = __decorate([inversify_1.injectable(), __param(0, inversify_1.inject(contracts_1.IInterpreterHelper))], InterpreterComparer);
exports.InterpreterComparer = InterpreterComparer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImludGVycHJldGVyQ29tcGFyZXIuanMiXSwibmFtZXMiOlsiX19kZWNvcmF0ZSIsImRlY29yYXRvcnMiLCJ0YXJnZXQiLCJrZXkiLCJkZXNjIiwiYyIsImFyZ3VtZW50cyIsImxlbmd0aCIsInIiLCJPYmplY3QiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJkIiwiUmVmbGVjdCIsImRlY29yYXRlIiwiaSIsImRlZmluZVByb3BlcnR5IiwiX19wYXJhbSIsInBhcmFtSW5kZXgiLCJkZWNvcmF0b3IiLCJleHBvcnRzIiwidmFsdWUiLCJpbnZlcnNpZnlfMSIsInJlcXVpcmUiLCJyZWdpc3RyeV8xIiwiY29udHJhY3RzXzEiLCJJbnRlcnByZXRlckNvbXBhcmVyIiwiY29uc3RydWN0b3IiLCJpbnRlcnByZXRlckhlbHBlciIsImNvbXBhcmUiLCJhIiwiYiIsIm5hbWVBIiwiZ2V0U29ydE5hbWUiLCJuYW1lQiIsImluZm8iLCJzb3J0TmFtZVBhcnRzIiwiZW52U3VmZml4UGFydHMiLCJ2ZXJzaW9uX2luZm8iLCJwdXNoIiwic2xpY2UiLCJqb2luIiwiYXJjaGl0ZWN0dXJlIiwiZ2V0QXJjaGl0ZWN0dXJlRGlzcGxheU5hbWUiLCJjb21wYW55RGlzcGxheU5hbWUiLCJ0cmltIiwidHlwZSIsIm5hbWUiLCJnZXRJbnRlcnByZXRlclR5cGVEaXNwbGF5TmFtZSIsImVudk5hbWUiLCJlbnZTdWZmaXgiLCJpbmplY3RhYmxlIiwiaW5qZWN0IiwiSUludGVycHJldGVySGVscGVyIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7O0FBQ0EsSUFBSUEsVUFBVSxHQUFJLFVBQVEsU0FBS0EsVUFBZCxJQUE2QixVQUFVQyxVQUFWLEVBQXNCQyxNQUF0QixFQUE4QkMsR0FBOUIsRUFBbUNDLElBQW5DLEVBQXlDO0FBQ25GLE1BQUlDLENBQUMsR0FBR0MsU0FBUyxDQUFDQyxNQUFsQjtBQUFBLE1BQTBCQyxDQUFDLEdBQUdILENBQUMsR0FBRyxDQUFKLEdBQVFILE1B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QUdTLFNBQVUsRUFBeEMsQ0FBMENMLElBQTFDLEVBQVA7QUFDSDs7QUE1QytDLENBQXBEO0FBOENBbkIsbUJBQW1CLEdBQUd6QixVQUFVLENBQUMsQ0FDN0JxQixXQUFXLENBQUM2QixVQUFaLEVBRDZCLEVBRTdCbEMsT0FBTyxDQUFDLENBQUQsRUFBSUssV0FBVyxDQUFDOEIsTUFBWixDQUFtQjNCLFdBQVcsQ0FBQzRCLGtCQUEvQixDQUFKLENBRnNCLENBQUQsRUFHN0IzQixtQkFINkIsQ0FBaEM7QUFJQU4sT0FBTyxDQUFDTSxtQkFBUixHQUE4QkEsbUJBQTlCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXG4ndXNlIHN0cmljdCc7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19wYXJhbSA9ICh0aGlzICYmIHRoaXMuX19wYXJhbSkgfHwgZnVuY3Rpb24gKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmNvbnN0IGludmVyc2lmeV8xID0gcmVxdWlyZShcImludmVyc2lmeVwiKTtcbmNvbnN0IHJlZ2lzdHJ5XzEgPSByZXF1aXJlKFwiLi4vLi4vY29tbW9uL3BsYXRmb3JtL3JlZ2lzdHJ5XCIpO1xuY29uc3QgY29udHJhY3RzXzEgPSByZXF1aXJlKFwiLi4vY29udHJhY3RzXCIpO1xubGV0IEludGVycHJldGVyQ29tcGFyZXIgPSBjbGFzcyBJbnRlcnByZXRlckNvbXBhcmVyIHtcbiAgICBjb25zdHJ1Y3RvcihpbnRlcnByZXRlckhlbHBlcikge1xuICAgICAgICB0aGlzLmludGVycHJldGVySGVscGVyID0gaW50ZXJwcmV0ZXJIZWxwZXI7XG4gICAgfVxuICAgIGNvbXBhcmUoYSwgYikge1xuICAgICAgICBjb25zdCBuYW1lQSA9IHRoaXMuZ2V0U29ydE5hbWUoYSk7XG4gICAgICAgIGNvbnN0IG5hbWVCID0gdGhpcy5nZXRTb3J0TmFtZShiKTtcbiAgICAgICAgaWYgKG5hbWVBID09PSBuYW1lQikge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5hbWVBID4gbmFtZUIgPyAxIDogLTE7XG4gICAgfVxuICAgIGdldFNvcnROYW1lKGluZm8pIHtcbiAgICAgICAgY29uc3Qgc29ydE5hbWVQYXJ0cyA9IFtdO1xuICAgICAgICBjb25zdCBlbnZTdWZmaXhQYXJ0cyA9IFtdO1xuICAgICAgICAvLyBTb3J0IG9yZGVyIGZvciBpbnRlcnByZXRlcnMgaXM6XG4gICAgICAgIC8vICogVmVyc2lvblxuICAgICAgICAvLyAqIEFyY2hpdGVjdHVyZVxuICAgICAgICAvLyAqIEludGVycHJldGVyIFR5cGVcbiAgICAgICAgLy8gKiBFbnZpcm9ubWVudCBuYW1lXG4gICAgICAgIGlmIChpbmZvLnZlcnNpb25faW5mbyAmJiBpbmZvLnZlcnNpb25faW5mby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBzb3J0TmFtZVBhcnRzLnB1c2goaW5mby52ZXJzaW9uX2luZm8uc2xpY2UoMCwgMykuam9pbignLicpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5mby5hcmNoaXRlY3R1cmUpIHtcbiAgICAgICAgICAgIHNvcnROYW1lUGFydHMucHVzaChyZWdpc3RyeV8xLmdldEFyY2hpdGVjdHVyZURpc3BsYXlOYW1lKGluZm8uYXJjaGl0ZWN0dXJlKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGluZm8uY29tcGFueURpc3BsYXlOYW1lICYmIGluZm8uY29tcGFueURpc3BsYXlOYW1lLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHNvcnROYW1lUGFydHMucHVzaChpbmZvLmNvbXBhbnlEaXNwbGF5TmFtZS50cmltKCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc29ydE5hbWVQYXJ0cy5wdXNoKCdQeXRob24nKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5mby50eXBlKSB7XG4gICAgICAgICAgICBjb25zdCBuYW1lID0gdGhpcy5pbnRlcnByZXRlckhlbHBlci5nZXRJbnRlcnByZXRlclR5cGVEaXNwbGF5TmFtZShpbmZvLnR5cGUpO1xuICAgICAgICAgICAgaWYgKG5hbWUpIHtcbiAgICAgICAgICAgICAgICBlbnZTdWZmaXhQYXJ0cy5wdXNoKG5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChpbmZvLmVudk5hbWUgJiYgaW5mby5lbnZOYW1lLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGVudlN1ZmZpeFBhcnRzLnB1c2goaW5mby5lbnZOYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlbnZTdWZmaXggPSBlbnZTdWZmaXhQYXJ0cy5sZW5ndGggPT09IDAgPyAnJyA6XG4gICAgICAgICAgICBgKCR7ZW52U3VmZml4UGFydHMuam9pbignOiAnKX0pYDtcbiAgICAgICAgcmV0dXJuIGAke3NvcnROYW1lUGFydHMuam9pbignICcpfSAke2VudlN1ZmZpeH1gLnRyaW0oKTtcbiAgICB9XG59O1xuSW50ZXJwcmV0ZXJDb21wYXJlciA9IF9fZGVjb3JhdGUoW1xuICAgIGludmVyc2lmeV8xLmluamVjdGFibGUoKSxcbiAgICBfX3BhcmFtKDAsIGludmVyc2lmeV8xLmluamVjdChjb250cmFjdHNfMS5JSW50ZXJwcmV0ZXJIZWxwZXIpKVxuXSwgSW50ZXJwcmV0ZXJDb21wYXJlcik7XG5leHBvcnRzLkludGVycHJldGVyQ29tcGFyZXIgPSBJbnRlcnByZXRlckNvbXBhcmVyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW50ZXJwcmV0ZXJDb21wYXJlci5qcy5tYXAiXX0=